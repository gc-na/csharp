<!--
Meta Description: # استخدام عبارة "finally" في لغة C# ## الملخص تستخدم عبارة "finally" في لغة C# لضمان تنفيذ كود معين بعد الانتهاء من كتلة try أو catch، بغض النظر عما إ...
Meta Keywords: finally, كتلة, catch, try, استثناء
-->

# استخدام عبارة "finally" في لغة C#

## الملخص
تستخدم عبارة "finally" في لغة C# لضمان تنفيذ كود معين بعد الانتهاء من كتلة try أو catch، بغض النظر عما إذا حدث استثناء أم لا.

## الوثائق
عبارة "finally" هي جزء من معالجة الاستثناءات في C#. تُستخدم مع كتلة "try" و"catch" لضمان تنفيذ كود معين، مثل تنظيف الموارد أو إغلاق الملفات، حتى لو حدث استثناء داخل الكود.

### الغرض
تساعد عبارة "finally" في ضمان استقرار البرنامج عن طريق تنفيذ كود معين في جميع الحالات، مما يجعل التعامل مع الموارد أكثر أمانًا.

### الاستخدام
تأتي عبارة "finally" بعد كتلتي "try" و"catch". يمكن استخدامها بعد كتلة "catch" واحدة أو أكثر، أو حتى بدونها.

### التفاصيل
- يمكن أن تحتوي كتلة "finally" على أي كود تحتاج إلى تنفيذه في النهاية، مثل إغلاق اتصالات الشبكة أو تحرير الذاكرة.
- في حالة عدم وجود استثناء، ستنفذ كتلة "finally" بعد الانتهاء من كتلة "try".
- إذا تم استثناء، ستنفذ كتلة "finally" بعد تنفيذ كتلة "catch".

## أمثلة
### مثال 1: استخدام finally مع try و catch
```csharp
try
{
    // كود قد يسبب استثناء
    int[] numbers = { 1, 2, 3 };
    Console.WriteLine(numbers[3]); // هذا سيسبب استثناء
}
catch (IndexOutOfRangeException ex)
{
    Console.WriteLine("حدث استثناء: " + ex.Message);
}
finally
{
    Console.WriteLine("تم الانتهاء من تنفيذ كتلة try/catch.");
}
```

### مثال 2: استخدام finally لإغلاق ملف
```csharp
FileStream fileStream = null;
try
{
    fileStream = new FileStream("example.txt", FileMode.Open);
    // معالجة الملف
}
catch (IOException ex)
{
    Console.WriteLine("حدث خطأ في الإدخال/الإخراج: " + ex.Message);
}
finally
{
    if (fileStream != null)
    {
        fileStream.Close();
        Console.WriteLine("تم إغلاق الملف.");
    }
}
```

## الشرح
- **المآزق الشائعة**: تأكد من عدم وجود كود قد يسبب استثناء داخل كتلة "finally"، حيث يمكن أن يؤدي هذا إلى عدم تنفيذ الكود المطلوب.
- **النقاط المهمة**: إذا كان هناك return statement في كتلة "try" أو "catch"، ستظل كتلة "finally" تُنفذ قبل مغادرة الدالة.

## ملخص جملة واحدة
تضمن عبارة "finally" في C# تنفيذ كود معين بعد كتلتي try و catch، مما يحسن من استقرار البرنامج أثناء معالجة الاستثناءات.