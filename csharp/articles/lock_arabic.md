<!--
Meta Description: # استخدام الأمر "lock" في لغة C# ## ملخص يعتبر الأمر "lock" في C# من الأدوات الأساسية التي تُستخدم لضمان سلامة الوصول إلى الموارد المشتركة من خلال الت...
Meta Keywords: lock, استخدام, إلى, خيط, object
-->

# استخدام الأمر "lock" في لغة C#

## ملخص
يعتبر الأمر "lock" في C# من الأدوات الأساسية التي تُستخدم لضمان سلامة الوصول إلى الموارد المشتركة من خلال التحكم في التزامن، مما يساعد في تجنب حالات التعارض (race conditions) عند تنفيذ الخيوط المتعددة.

## الوثائق
يُستخدم الأمر "lock" في C# لتأمين كتلة من التعليمات البرمجية، مما يضمن أن خيطًا واحدًا فقط يمكنه الوصول إلى المورد المشترك في وقت معين. يُعتبر "lock" بمثابة قفل على كائن معين، فعندما يُدخل خيط ما في كتلة "lock"، يتم قفل الكائن المحدد حتى يخرج الخيط من الكتلة.

### الاستخدام:
```csharp
lock (object) 
{
    // كود آمن يتم تنفيذه من قبل خيط واحد فقط
}
```

### التفاصيل:
- **الكائن:** يجب أن يكون الكائن المستخدم في الأمر "lock" كائنًا ثابتًا (static) أو كائنًا خاصًا لضمان عدم استخدامه من قبل خيوط أخرى.
- **الأداء:** استخدام "lock" يمكن أن يؤثر على أداء التطبيق في حالة استخدامه بشكل مفرط، لذا يجب استخدامه بحذر.
- **التعقيد:** ينبغي تجنب استخدام "lock" في كتل عميقة أو معقدة، مما قد يؤدي إلى قفل الخيوط لفترات طويلة.

## الأمثلة
### مثال 1: الاستخدام الأساسي
```csharp
private static readonly object _lockObject = new object();

public void SafeMethod()
{
    lock (_lockObject)
    {
        // تنفيذ كود آمن
    }
}
```

### مثال 2: تجنب التعارض
```csharp
private static int _counter = 0;
private static readonly object _lockObject = new object();

public void IncrementCounter()
{
    lock (_lockObject)
    {
        _counter++;
    }
}
```

## الشرح
### الفخاخ الشائعة:
- **استخدام الكائنات العامة:** من الخطر استخدام كائنات عامة كقفل، حيث يمكن أن يتحكم فيها أي خيط، مما يؤدي إلى مشكلات في التزامن.
- **عدم الخروج من القفل:** من المهم التأكد من أن كل خيط يخرج من القفل بشكل صحيح لتجنب القفل الدائم (deadlock).
- **استخدام القفل على الكائنات الكبيرة:** يجب تجنب القفل على كائنات كبيرة أو متداخلة، لأن ذلك يمكن أن يؤدي إلى تقليل الأداء.

## ملخص في جملة واحدة
يعد "lock" في C# أداة فعالة لضمان الوصول المتزامن الآمن إلى الموارد المشتركة بين الخيوط.